{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql.types import StructType, StructField, DoubleType, StringType\nschema = StructType([\n    # Represents a field in a StructType\n    StructField(\"IP\",           StringType()),\n    StructField(\"Time\",         StringType()),\n    StructField(\"Request_Type\", StringType()),\n    StructField(\"Response_Code\",StringType()),\n    StructField(\"City\",         StringType()),\n    StructField(\"Country\",      StringType()),\n    StructField(\"Isocode\",      StringType()),\n    StructField(\"Latitude\",     StringType()),\n    StructField(\"Longitude\",    StringType())\n])\n\nlogs_df = sqlContext.read \\\n                    .format(\"com.databricks.spark.csv\") \\\n                    .schema(schema) \\\n                    .option(\"header\", \"false\") \\\n                    .option(\"delimiter\", \"|\") \\\n                    .load(\"/nifi/\")\nlogs_df.show(truncate=False)\n# Creating dataframe and loading the schema\n","user":"admin","dateUpdated":"2024-04-04T19:55:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+--------------------------+------------------------------------------------------------+-------------+-----------+-------------+-------+--------+---------+\n|IP           |Time                      |Request_Type                                                |Response_Code|City       |Country      |Isocode|Latitude|Longitude|\n+-------------+--------------------------+------------------------------------------------------------+-------------+-----------+-------------+-------+--------+---------+\n|128.227.97.61|13/Aug/1995:11:41:30 -0400|GET /images/NASA-logosmall.gif HTTP/1.0                     |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:30 -0400|GET /images/KSC-logosmall.gif HTTP/1.0                      |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:36 -0400|GET /shuttle/missions/sts-78/mission-sts-78.html HTTP/1.0   |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:37 -0400|GET /shuttle/missions/sts-78/sts-78-patch-small.gif HTTP/1.0|200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:37 -0400|GET /images/launch-logo.gif HTTP/1.0                        |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:37 -0400|GET /history/apollo/images/apollo-logo1.gif HTTP/1.0        |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:42 -0400|GET /shuttle/missions/sts-77/mission-sts-77.html HTTP/1.0   |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:48 -0400|GET /shuttle/missions/sts-77/sts-77-patch-small.gif HTTP/1.0|200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:54 -0400|GET /shuttle/missions/sts-76/mission-sts-76.html HTTP/1.0   |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:41:55 -0400|GET /shuttle/missions/sts-76/sts-76-patch-small.gif HTTP/1.0|200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:00 -0400|GET /shuttle/missions/sts-75/mission-sts-75.html HTTP/1.0   |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:01 -0400|GET /shuttle/missions/sts-75/sts-75-patch-small.gif HTTP/1.0|200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:09 -0400|GET /shuttle/missions/sts-73/mission-sts-73.html HTTP/1.0   |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:10 -0400|GET /shuttle/missions/sts-73/sts-73-patch-small.gif HTTP/1.0|200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:13 -0400|GET /shuttle/missions/sts-73/sts-73-patch.jpg HTTP/1.0      |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:20 -0400|GET /shuttle/missions/sts-74/mission-sts-74.html HTTP/1.0   |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:20 -0400|GET /shuttle/missions/sts-74/sts-74-patch-small.gif HTTP/1.0|200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:29 -0400|GET /shuttle/missions/sts-72/mission-sts-72.html HTTP/1.0   |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:30 -0400|GET /shuttle/missions/sts-72/sts-72-patch-small.gif HTTP/1.0|200          |Gainesville|United States|US     |29.684  |-82.3569 |\n|128.227.97.61|13/Aug/1995:11:42:37 -0400|GET /shuttle/missions/sts-70/mission-sts-70.html HTTP/1.0   |200          |Gainesville|United States|US     |29.684  |-82.3569 |\n+-------------+--------------------------+------------------------------------------------------------+-------------+-----------+-------------+-------+--------+---------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635564_1291803402","id":"20230926-103503_163567338","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:39+0000","dateFinished":"2024-04-04T19:55:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1490"},{"text":"%pyspark\nfrom pyspark.sql.functions import udf\n# From the Time column, we will parse for the timestamp and drop the old Time column with the new Timestamp column.\nmonths = {\n  'Jan': 1, 'Feb': 2, 'Mar':3, 'Apr':4, 'May':5, 'Jun':6, 'Jul':7, 'Aug':8,  'Sep': 9, 'Oct':10, 'Nov': 11, 'Dec': 12\n}\n\ndef parse_timestamp(time):\n    \"\"\" This function takes a Time string parameter of logs_df dataframe\n    Returns a string suitable for passing to CAST('timestamp') in the format YYYY-MM-DD hh:mm:ss\n    \"\"\"\n    return \"{0:04d}-{1:02d}-{2:02d} {3:02d}:{4:02d}:{5:02d}\".format(\n      int(time[7:11]),\n      months[time[3:6]],\n      int(time[0:2]),\n      int(time[12:14]),\n      int(time[15:17]),\n      int(time[18:20])\n    )\n\nudf_parse_timestamp = udf(parse_timestamp)\n\n# Assigning the Timestamp name to the new column and dropping the old Time column\nparsed_df = logs_df.select('*',\n                udf_parse_timestamp(logs_df['Time'])\n                .cast('timestamp')\n                .alias('Timestamp')).drop('Time')  \n# Stores the dataframe in cache for the future use\nparsed_df.cache()                                  \n# Displays the results\nparsed_df.show()","user":"admin","dateUpdated":"2024-04-04T19:55:40+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+--------------------+-------------+-----------+-------------+-------+--------+---------+-------------------+\n|           IP|        Request_Type|Response_Code|       City|      Country|Isocode|Latitude|Longitude|          Timestamp|\n+-------------+--------------------+-------------+-----------+-------------+-------+--------+---------+-------------------+\n|128.227.97.61|GET /images/NASA-...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:30|\n|128.227.97.61|GET /images/KSC-l...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:30|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:36|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|\n|128.227.97.61|GET /images/launc...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|\n|128.227.97.61|GET /history/apol...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:42|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:48|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:54|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:55|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:00|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:01|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:09|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:10|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:13|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:20|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:20|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:29|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:30|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:37|\n+-------------+--------------------+-------------+-----------+-------------+-------+--------+---------+-------------------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635568_-1963160902","id":"20230926-103511_1990246779","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:41+0000","dateFinished":"2024-04-04T19:55:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1491"},{"text":"%pyspark\nfrom pyspark.sql.functions import split, regexp_extract\n\n# Cleaning the Request_Type Column\n# Currently the Request_type has GET and HTTP/1.0 surrounding the actual data being requested, so we will remove these two from each line.\n\npath_df = parsed_df.select('*', regexp_extract('Request_Type', r'^.*\\w+\\s+([^\\s]+)\\s+HTTP.*', 1)\n                    .alias('Request_Path')).drop('Request_Type')\n\n# Cache the dataframe\npath_df.cache()\n# Displays the results\npath_df.show(truncate=False)","user":"admin","dateUpdated":"2024-04-04T19:55:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-------------+-----------+-------------+-------+--------+---------+-------------------+-----------------------------------------------+\n|IP           |Response_Code|City       |Country      |Isocode|Latitude|Longitude|Timestamp          |Request_Path                                   |\n+-------------+-------------+-----------+-------------+-------+--------+---------+-------------------+-----------------------------------------------+\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:30|/images/NASA-logosmall.gif                     |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:30|/images/KSC-logosmall.gif                      |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:36|/shuttle/missions/sts-78/mission-sts-78.html   |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:37|/shuttle/missions/sts-78/sts-78-patch-small.gif|\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:37|/images/launch-logo.gif                        |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:37|/history/apollo/images/apollo-logo1.gif        |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:42|/shuttle/missions/sts-77/mission-sts-77.html   |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:48|/shuttle/missions/sts-77/sts-77-patch-small.gif|\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:54|/shuttle/missions/sts-76/mission-sts-76.html   |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:41:55|/shuttle/missions/sts-76/sts-76-patch-small.gif|\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:00|/shuttle/missions/sts-75/mission-sts-75.html   |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:01|/shuttle/missions/sts-75/sts-75-patch-small.gif|\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:09|/shuttle/missions/sts-73/mission-sts-73.html   |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:10|/shuttle/missions/sts-73/sts-73-patch-small.gif|\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:13|/shuttle/missions/sts-73/sts-73-patch.jpg      |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:20|/shuttle/missions/sts-74/mission-sts-74.html   |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:20|/shuttle/missions/sts-74/sts-74-patch-small.gif|\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:29|/shuttle/missions/sts-72/mission-sts-72.html   |\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:30|/shuttle/missions/sts-72/sts-72-patch-small.gif|\n|128.227.97.61|200          |Gainesville|United States|US     |29.684  |-82.3569 |1995-08-13 11:42:37|/shuttle/missions/sts-70/mission-sts-70.html   |\n+-------------+-------------+-----------+-------------+-------+--------+---------+-------------------+-----------------------------------------------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635569_1729045637","id":"20230926-111744_1363671243","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:42+0000","dateFinished":"2024-04-04T19:55:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1492"},{"text":"%pyspark\n\n# Filtering for Most Frequent Hosts Hitting NASA Server\n# We want to filter on which which hosts are most frequently hitting NASA's server and then store the data into a temporary table.\n\n# Group the dataframe by IP column and then counting\nmost_frequent_hosts = parsed_df.groupBy(\"IP\").count()\n\n# Displays the results\nmost_frequent_hosts.show()\n\n# Registering most_frequent_hosts variable as a temporary table\nmost_frequent_hosts.registerTempTable(\"most_frequent_hosts\")","user":"admin","dateUpdated":"2024-04-04T19:55:43+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+-----+\n|             IP|count|\n+---------------+-----+\n|  164.116.78.80|   29|\n|   198.16.21.89|   10|\n| 132.170.244.49|   12|\n|  134.39.70.204|   63|\n|   140.225.7.13|    4|\n| 128.200.148.26|   53|\n| 147.162.26.105|    1|\n|  204.148.32.16|   10|\n| 204.56.131.122|   11|\n|  163.205.80.44|  112|\n| 147.222.27.131|   16|\n| 140.251.205.85|    5|\n| 151.99.240.201|   16|\n|  192.93.254.48|    5|\n|   152.43.32.90|   15|\n| 147.147.201.49|    8|\n| 159.121.38.213|   26|\n| 141.211.22.120|    9|\n| 138.253.42.199|    6|\n|131.188.160.155|    6|\n+---------------+-----+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635570_-988266405","id":"20230926-111822_475073188","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:43+0000","dateFinished":"2024-04-04T19:55:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1493"},{"text":"%pyspark\n# Filtering for Count of Each Response Code\n# Our aim is to find the amount of times that each response code has occurred and store the result into a temporary table for later use.\n\n# Groups the dataframe by Response_Code column and then counting\nstatus_count = path_df.groupBy('Response_Code').count()\n# Displays the results\nstatus_count.show()\n# Registering status_count variable as a temporary table\nstatus_count.registerTempTable(\"status_count\")\n","user":"admin","dateUpdated":"2024-04-04T19:55:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-----+\n|Response_Code|count|\n+-------------+-----+\n|          200|53674|\n|         null|   74|\n|          302| 1074|\n|          404|  340|\n|          304| 3376|\n+-------------+-----+"}]},"apps":[],"jobName":"paragraph_1712258635571_871391360","id":"20230926-111919_962071739","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:50+0000","dateFinished":"2024-04-04T19:55:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1494"},{"text":"%pyspark\n\n# Filtering Records Where Response Code is 200\n# Create the dataframe where records with Response Code 200 will be stored, cache the dataframe and display the results.\n\n# Creating dataframe where Response Code is 200\nsuccess_logs_df = parsed_df.select('*').filter(path_df['Response_Code'] == 200)\n# Cache the dataframe\nsuccess_logs_df.cache()\n# Displays the results\nsuccess_logs_df.show()","user":"admin","dateUpdated":"2024-04-04T19:55:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+--------------------+-------------+-----------+-------------+-------+--------+---------+-------------------+\n|           IP|        Request_Type|Response_Code|       City|      Country|Isocode|Latitude|Longitude|          Timestamp|\n+-------------+--------------------+-------------+-----------+-------------+-------+--------+---------+-------------------+\n|128.227.97.61|GET /images/NASA-...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:30|\n|128.227.97.61|GET /images/KSC-l...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:30|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:36|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|\n|128.227.97.61|GET /images/launc...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|\n|128.227.97.61|GET /history/apol...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:42|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:48|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:54|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:55|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:00|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:01|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:09|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:10|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:13|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:20|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:20|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:29|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:30|\n|128.227.97.61|GET /shuttle/miss...|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:37|\n+-------------+--------------------+-------------+-----------+-------------+-------+--------+---------+-------------------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635572_-1836109305","id":"20230926-111944_1555052794","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:53+0000","dateFinished":"2024-04-04T19:55:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1495"},{"text":"%pyspark\n#Extract the hour, display the results and register the dataframe as a temporary table for the SQL interpreter to use later.\nfrom pyspark.sql.functions import hour\n# Extracting the Hour\nsuccess_logs_by_hours_df = success_logs_df.select(hour('Timestamp').alias('Hour')).groupBy('Hour').count()\n# Displays the results\nsuccess_logs_by_hours_df.show()\n# Registering Temporary Table that can be used by SQL interpreter\nsuccess_logs_by_hours_df.registerTempTable(\"success_logs_by_hours_df\")","user":"admin","dateUpdated":"2024-04-04T19:55:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+\n|Hour|count|\n+----+-----+\n|  12| 3866|\n|  22| 2041|\n|   1| 1137|\n|  13| 3998|\n|  16| 3759|\n|   6| 1090|\n|   3|  808|\n|  20| 1882|\n|   5| 1154|\n|  19| 2042|\n|  15| 3949|\n|  17| 2975|\n|   9| 2126|\n|   4|  764|\n|   8| 1664|\n|  23| 1804|\n|   7| 1672|\n|  10| 2824|\n|  21| 1724|\n|  11| 3142|\n+----+-----+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635573_1282790550","id":"20230926-120019_1855013730","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:54+0000","dateFinished":"2024-04-04T19:55:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1496"},{"text":"%pyspark\n\n# Cleaning the Request_Path Column for Type Extensions\n# The Request_Path column contains the type extension. We will first show the current state of the Request_Path column before cleaning is done.\n\n# Show the current Request_Path Column before applying cleansing\nfrom pyspark.sql.functions import split, regexp_extract\nextension_df = path_df.select(regexp_extract('Request_Path', '(\\\\.[^.]+)$',1).alias('Extension'))\nextension_df.show(truncate=False)","user":"admin","dateUpdated":"2024-04-04T19:55:56+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+\n|Extension|\n+---------+\n|.gif     |\n|.gif     |\n|.html    |\n|.gif     |\n|.gif     |\n|.gif     |\n|.html    |\n|.gif     |\n|.html    |\n|.gif     |\n|.html    |\n|.gif     |\n|.html    |\n|.gif     |\n|.jpg     |\n|.html    |\n|.gif     |\n|.html    |\n|.gif     |\n|.html    |\n+---------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635574_-1209383554","id":"20230926-120044_1766378264","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:56+0000","dateFinished":"2024-04-04T19:55:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1497"},{"text":"%pyspark\n# How Should We Clean this Request_Path Column?\n# In the column, we see that each extension has a dot (.). We will replace this character with a blank character.\n\nfrom pyspark.sql.functions import split, regexp_replace\n# Replace the dot character with the blank character\nextension_df = extension_df.select(regexp_replace('Extension', '\\.','').alias('Extension'))\n# Displays the results\nextension_df.show(truncate=False)","user":"admin","dateUpdated":"2024-04-04T19:55:57+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+\n|Extension|\n+---------+\n|gif      |\n|gif      |\n|html     |\n|gif      |\n|gif      |\n|gif      |\n|html     |\n|gif      |\n|html     |\n|gif      |\n|html     |\n|gif      |\n|html     |\n|gif      |\n|jpg      |\n|html     |\n|gif      |\n|html     |\n|gif      |\n|html     |\n+---------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635574_-1087648062","id":"20230926-123648_1233816163","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:57+0000","dateFinished":"2024-04-04T19:55:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1498"},{"text":"%pyspark\n# There may also be some rows in the column that are blank, so we will replace a blank row with the word None.\n\nfrom pyspark.sql.functions import *\n# Replaces the blank value with the value 'None' in Extension\nextension_df = extension_df.replace('', 'None', 'Extension').alias('Extension')\nextension_df.cache()\n# Shows the results\nextension_df.show(truncate=False)","user":"admin","dateUpdated":"2024-04-04T19:55:59+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+\n|Extension|\n+---------+\n|gif      |\n|gif      |\n|html     |\n|gif      |\n|gif      |\n|gif      |\n|html     |\n|gif      |\n|html     |\n|gif      |\n|html     |\n|gif      |\n|html     |\n|gif      |\n|jpg      |\n|html     |\n|gif      |\n|html     |\n|gif      |\n|html     |\n+---------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635575_1453593708","id":"20230926-123850_1728207260","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:55:59+0000","dateFinished":"2024-04-04T19:56:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1499"},{"text":"%pyspark\n# Next we will group the dataframe by extension type, count the rows, display the results and register the dataframe in a temporary table.\n\n# Groups the dataframe by Extension and then count the rows\nextension_df_count = extension_df.groupBy('Extension').count()\n# Displays the results\nextension_df_count.show()\n# Registers the temporary table\nextension_df_count.registerTempTable('extension_df_count')","user":"admin","dateUpdated":"2024-04-04T19:56:00+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|           Extension|count|\n+--------------------+-----+\n|   pl?MIR-Rendezvous|    2|\n|                 jpg| 1100|\n|                 map|   12|\n|                 wav|   69|\n|       pl?challenger|    1|\n|pl?august+1995+la...|    1|\n|           pl?STS-73|    2|\n|           pl?TDRS-A|    1|\n|        pl?souvenirs|    1|\n|             pl?IMAX|   11|\n|  pl?launch+and+pass|    1|\n|           pl?sts-69|    1|\n|   pl?shuttle+status|    1|\n|   pl?see+AND+launch|    1|\n|             pl?IPMP|    1|\n|pl?INTELSAT-VI-RE...|    2|\n|                jpeg|   50|\n|         pl?apollo13|    1|\n|           news/1969|    1|\n|                None| 5250|\n+--------------------+-----+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635575_-1367667864","id":"20230926-123941_283664807","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:56:00+0000","dateFinished":"2024-04-04T19:56:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1500"},{"text":"%pyspark\n# Create a temporary table for DataFrame path_df.\n\npath_df.registerTempTable(\"path_df\")","user":"admin","dateUpdated":"2024-04-04T19:56:01+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1712258635576_-914832984","id":"20230926-124004_1970627337","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:56:01+0000","dateFinished":"2024-04-04T19:56:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1501"},{"text":"%pyspark\npath_df.show()","user":"admin","dateUpdated":"2024-04-04T19:56:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+-------------+-----------+-------------+-------+--------+---------+-------------------+--------------------+\n|           IP|Response_Code|       City|      Country|Isocode|Latitude|Longitude|          Timestamp|        Request_Path|\n+-------------+-------------+-----------+-------------+-------+--------+---------+-------------------+--------------------+\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:30|/images/NASA-logo...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:30|/images/KSC-logos...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:36|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|/images/launch-lo...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:37|/history/apollo/i...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:42|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:48|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:54|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:41:55|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:00|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:01|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:09|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:10|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:13|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:20|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:20|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:29|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:30|/shuttle/missions...|\n|128.227.97.61|          200|Gainesville|United States|     US|  29.684| -82.3569|1995-08-13 11:42:37|/shuttle/missions...|\n+-------------+-------------+-----------+-------------+-------+--------+---------+-------------------+--------------------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1712258635577_430950127","id":"20230928-110235_1140318587","dateCreated":"2024-04-04T19:23:55+0000","dateStarted":"2024-04-04T19:56:02+0000","dateFinished":"2024-04-04T19:56:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1502"},{"text":"%pyspark\n\nfrom pyspark.sql import SparkSession\nconf = spark.sparkContext._conf.setAll([('spark.sql.htl.check','false'), ('mapreduce.input.fileinputformat.input.dir.recursive','true')])\n\nspark = SparkSession.builder \\\n    .appName(\"Zeppelin Hive Table Creation\") \\\n    .enableHiveSupport() \\\n    .config(conf=conf) \\\n    .getOrCreate()\n    \n# Create the most_frequent_hosts table in Hive and insert data\nspark.sql(\"\"\"\n    CREATE TABLE IF NOT EXISTS default.most_frequent_hosts (\n        IP STRING,\n        count INT\n    )\n\"\"\")\n\nspark.sql(\"\"\"\n    INSERT INTO  default.most_frequent_hosts\n    SELECT * FROM most_frequent_hosts\n\"\"\")\n\n# Create the status_count table in Hive and insert data\n\nspark.sql(\"\"\"\n    CREATE TABLE IF NOT EXISTS default.status_count (\n        response_code STRING,\n        count INT\n    )\n\"\"\")\n\nspark.sql(\"\"\"\n    INSERT INTO  default.status_count\n    SELECT * FROM status_count\n\"\"\")\n          \n# Create the success_logs_by_hours_df table in Hive and insert data\n\nspark.sql(\"\"\"\n    CREATE TABLE IF NOT EXISTS default.success_logs_by_hours_df (\n        hour INT,\n        count INT\n    )\n\"\"\")\n\nspark.sql(\"\"\"\n    INSERT INTO  default.success_logs_by_hours_df\n    SELECT * FROM success_logs_by_hours_df\n\"\"\")\n          \n# Create the extension_df_count table in Hive and insert data\n\nspark.sql(\"\"\"\n    CREATE TABLE IF NOT EXISTS default.extension_df_count (\n        extension STRING,\n        count INT\n    )\n\"\"\")\n\nspark.sql(\"\"\"\n    INSERT INTO  default.extension_df_count\n    SELECT * FROM extension_df_count\n\"\"\")\n          \n# Create the xy table in Hive and insert data\n\nspark.sql(\"\"\"\n    CREATE TABLE IF NOT EXISTS default.xy (\n        response_code STRING,\n        count INT\n    )\n\"\"\")\n\nspark.sql(\"\"\"\n    INSERT INTO  default.xy\n    SELECT * FROM xy\n\"\"\")\n\n          \n# Create the path_df table in Hive and insert data\n\nspark.sql(\"\"\"\n    CREATE TABLE IF NOT EXISTS default.path_df (\n        ip STRING,\n        response_code STRING, \n        city STRING,\n        country STRING,\n        isocode STRING,\n        latitude STRING,\n        longitude STRING,\n        timestamp STRING, \n        request_path STRING\n\n    )\n\"\"\")\n\nspark.sql(\"\"\"\n    INSERT INTO  default.path_df\n    SELECT * FROM path_df\n\"\"\")\n\n\n","user":"admin","dateUpdated":"2024-04-04T19:59:51+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"path_df.ip":"string","path_df.response_code":"string","path_df.city":"string","path_df.country":"string","path_df.isocode":"string","path_df.latitude":"string","path_df.longitude":"string","path_df.timestamp":"string","path_df.request_path":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"path_df.ip","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"path_df.response_code","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1712258635579_1297868795","id":"20230928-110803_166085790","dateCreated":"2024-04-04T19:23:55+0000","status":"RUNNING","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1504","dateStarted":"2024-04-04T19:59:51+0000"}],"name":"Cleaning-Raw-NASA-Log-Data","id":"2JUHRC348","noteParams":{},"noteForms":{},"angularObjects":{"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}